<?xml version="1.0" encoding="utf-8"?>
<Page
    x:Class="SAM.WinUI.Views.DiagnosticsPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="using:SAM.WinUI.Views">

    <ScrollViewer>
        <StackPanel Padding="0,0,0,24" MaxWidth="900" HorizontalAlignment="Left">
            <!-- Header with Refresh -->
            <Grid Margin="0,0,0,24">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                
                <TextBlock x:Name="PageTitleText" Text="Diagnostics" 
                           Style="{StaticResource TitleLargeTextBlockStyle}"/>
                
                <StackPanel Grid.Column="1" Orientation="Horizontal" Spacing="8">
                    <Button x:Name="CopyInfoButton"
                            Click="CopyInfoButton_Click"
                            ToolTipService.ToolTip="Copy all info to clipboard">
                        <StackPanel Orientation="Horizontal" Spacing="8">
                            <FontIcon Glyph="&#xE8C8;" FontSize="14"/>
                            <TextBlock x:Name="CopyButtonText" Text="Copy"/>
                        </StackPanel>
                    </Button>
                    <Button x:Name="RefreshButton"
                            Click="RefreshButton_Click"
                            ToolTipService.ToolTip="Refresh diagnostic info">
                        <StackPanel Orientation="Horizontal" Spacing="8">
                            <FontIcon Glyph="&#xE72C;" FontSize="14"/>
                            <TextBlock x:Name="RefreshButtonText" Text="Refresh"/>
                        </StackPanel>
                    </Button>
                </StackPanel>
            </Grid>

            <!-- System Information -->
            <StackPanel Orientation="Horizontal" Spacing="8" Margin="0,0,0,8">
                <FontIcon Glyph="&#xE7F4;" FontSize="18" Foreground="{ThemeResource AccentTextFillColorPrimaryBrush}"/>
                <TextBlock x:Name="SystemSectionText" Text="System" Style="{StaticResource BodyStrongTextBlockStyle}"/>
            </StackPanel>
            
            <Border Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
                    BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                    BorderThickness="1"
                    CornerRadius="8"
                    Padding="16"
                    Margin="0,0,0,16">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="200"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>

                    <TextBlock x:Name="OsLabel" Text="Operating System:" 
                               Style="{StaticResource BodyTextBlockStyle}"
                               Foreground="{ThemeResource TextFillColorSecondaryBrush}"/>
                    <TextBlock x:Name="OsVersionText" 
                               Grid.Column="1"
                               Style="{StaticResource BodyTextBlockStyle}"
                               IsTextSelectionEnabled="True"/>

                    <TextBlock x:Name="DotNetLabel" Text=".NET Runtime:" 
                               Grid.Row="1"
                               Style="{StaticResource BodyTextBlockStyle}"
                               Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                               Margin="0,8,0,0"/>
                    <TextBlock x:Name="DotNetVersionText" 
                               Grid.Row="1" Grid.Column="1"
                               Style="{StaticResource BodyTextBlockStyle}"
                               IsTextSelectionEnabled="True"
                               Margin="0,8,0,0"/>

                    <TextBlock x:Name="WinAppSdkLabel" Text="Windows App SDK:" 
                               Grid.Row="2"
                               Style="{StaticResource BodyTextBlockStyle}"
                               Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                               Margin="0,8,0,0"/>
                    <TextBlock x:Name="WinAppSdkVersionText" 
                               Grid.Row="2" Grid.Column="1"
                               Style="{StaticResource BodyTextBlockStyle}"
                               IsTextSelectionEnabled="True"
                               Margin="0,8,0,0"/>

                    <TextBlock x:Name="AppVersionLabel" Text="App Version:" 
                               Grid.Row="3"
                               Style="{StaticResource BodyTextBlockStyle}"
                               Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                               Margin="0,8,0,0"/>
                    <TextBlock x:Name="AppVersionText" 
                               Grid.Row="3" Grid.Column="1"
                               Style="{StaticResource BodyTextBlockStyle}"
                               IsTextSelectionEnabled="True"
                               Margin="0,8,0,0"/>

                    <TextBlock x:Name="ArchLabel" Text="Process Architecture:" 
                               Grid.Row="4"
                               Style="{StaticResource BodyTextBlockStyle}"
                               Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                               Margin="0,8,0,0"/>
                    <TextBlock x:Name="ArchitectureText" 
                               Grid.Row="4" Grid.Column="1"
                               Style="{StaticResource BodyTextBlockStyle}"
                               IsTextSelectionEnabled="True"
                               Margin="0,8,0,0"/>

                    <TextBlock x:Name="MemoryLabel" Text="Memory Usage:" 
                               Grid.Row="5"
                               Style="{StaticResource BodyTextBlockStyle}"
                               Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                               Margin="0,8,0,0"/>
                    <TextBlock x:Name="MemoryUsageText" 
                               Grid.Row="5" Grid.Column="1"
                               Style="{StaticResource BodyTextBlockStyle}"
                               IsTextSelectionEnabled="True"
                               Margin="0,8,0,0"/>

                    <TextBlock x:Name="ProcessIdLabel" Text="Process ID:" 
                               Grid.Row="6"
                               Style="{StaticResource BodyTextBlockStyle}"
                               Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                               Margin="0,8,0,0"/>
                    <TextBlock x:Name="ProcessIdText" 
                               Grid.Row="6" Grid.Column="1"
                               Style="{StaticResource BodyTextBlockStyle}"
                               IsTextSelectionEnabled="True"
                               Margin="0,8,0,0"/>
                </Grid>
            </Border>

            <!-- Steam Status -->
            <StackPanel Orientation="Horizontal" Spacing="8" Margin="0,8,0,8">
                <FontIcon Glyph="&#xE7FC;" FontSize="18" Foreground="{ThemeResource AccentTextFillColorPrimaryBrush}"/>
                <TextBlock x:Name="SteamSectionText" Text="Steam" Style="{StaticResource BodyStrongTextBlockStyle}"/>
            </StackPanel>
            
            <Border Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
                    BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                    BorderThickness="1"
                    CornerRadius="8"
                    Padding="16"
                    Margin="0,0,0,16">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="200"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>

                    <TextBlock x:Name="ConnectionStatusLabel" Text="Connection Status:" 
                               Style="{StaticResource BodyTextBlockStyle}"
                               Foreground="{ThemeResource TextFillColorSecondaryBrush}"/>
                    <StackPanel Grid.Column="1" Orientation="Horizontal" Spacing="8">
                        <FontIcon x:Name="SteamStatusIcon" 
                                  Glyph="&#xE9CE;" 
                                  FontSize="16"/>
                        <TextBlock x:Name="SteamStatusText" 
                                   Style="{StaticResource BodyTextBlockStyle}"
                                   IsTextSelectionEnabled="True"/>
                    </StackPanel>

                    <TextBlock x:Name="SteamUserIdLabel" Text="Steam User ID:" 
                               Grid.Row="1"
                               Style="{StaticResource BodyTextBlockStyle}"
                               Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                               Margin="0,8,0,0"/>
                    <TextBlock x:Name="SteamUserIdText" 
                               Grid.Row="1" Grid.Column="1"
                               Style="{StaticResource BodyTextBlockStyle}"
                               IsTextSelectionEnabled="True"
                               Margin="0,8,0,0"/>

                    <TextBlock x:Name="GameCountLabel" Text="Game Count:" 
                               Grid.Row="2"
                               Style="{StaticResource BodyTextBlockStyle}"
                               Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                               Margin="0,8,0,0"/>
                    <TextBlock x:Name="GameCountText" 
                               Grid.Row="2" Grid.Column="1"
                               Style="{StaticResource BodyTextBlockStyle}"
                               IsTextSelectionEnabled="True"
                               Margin="0,8,0,0"/>

                    <TextBlock x:Name="SteamPathLabel" Text="Steam Installation Path:" 
                               Grid.Row="3"
                               Style="{StaticResource BodyTextBlockStyle}"
                               Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                               Margin="0,8,0,0"/>
                    <TextBlock x:Name="SteamPathText" 
                               Grid.Row="3" Grid.Column="1"
                               Style="{StaticResource BodyTextBlockStyle}"
                               TextWrapping="Wrap"
                               IsTextSelectionEnabled="True"
                               Margin="0,8,0,0"/>

                    <TextBlock x:Name="SteamApiStatusLabel" Text="steam_api.dll Status:" 
                               Grid.Row="4"
                               Style="{StaticResource BodyTextBlockStyle}"
                               Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                               Margin="0,8,0,0"/>
                    <StackPanel Grid.Row="4" Grid.Column="1" Orientation="Horizontal" Spacing="8" Margin="0,8,0,0">
                        <FontIcon x:Name="SteamApiStatusIcon" 
                                  Glyph="&#xE9CE;" 
                                  FontSize="16"/>
                        <TextBlock x:Name="SteamApiStatusText" 
                                   Style="{StaticResource BodyTextBlockStyle}"
                                   IsTextSelectionEnabled="True"/>
                    </StackPanel>
                </Grid>
            </Border>

            <!-- Storage -->
            <StackPanel Orientation="Horizontal" Spacing="8" Margin="0,8,0,8">
                <FontIcon Glyph="&#xE8B7;" FontSize="18" Foreground="{ThemeResource AccentTextFillColorPrimaryBrush}"/>
                <TextBlock x:Name="StorageSectionText" Text="Storage" Style="{StaticResource BodyStrongTextBlockStyle}"/>
            </StackPanel>
            
            <Border Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
                    BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                    BorderThickness="1"
                    CornerRadius="8"
                    Padding="16"
                    Margin="0,0,0,16">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="200"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>

                    <TextBlock x:Name="AppDataFolderLabel" Text="App Data Folder:" 
                               Style="{StaticResource BodyTextBlockStyle}"
                               Foreground="{ThemeResource TextFillColorSecondaryBrush}"/>
                    <TextBlock x:Name="AppDataPathText" 
                               Grid.Column="1"
                               Style="{StaticResource BodyTextBlockStyle}"
                               TextWrapping="Wrap"
                               IsTextSelectionEnabled="True"/>

                    <TextBlock x:Name="SettingsFileLabel" Text="Settings File:" 
                               Grid.Row="1"
                               Style="{StaticResource BodyTextBlockStyle}"
                               Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                               Margin="0,8,0,0"/>
                    <TextBlock x:Name="SettingsPathText" 
                               Grid.Row="1" Grid.Column="1"
                               Style="{StaticResource BodyTextBlockStyle}"
                               TextWrapping="Wrap"
                               IsTextSelectionEnabled="True"
                               Margin="0,8,0,0"/>

                    <TextBlock x:Name="ImageCacheLabel" Text="Image Cache:" 
                               Grid.Row="2"
                               Style="{StaticResource BodyTextBlockStyle}"
                               Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                               Margin="0,8,0,0"/>
                    <TextBlock x:Name="ImageCachePathText" 
                               Grid.Row="2" Grid.Column="1"
                               Style="{StaticResource BodyTextBlockStyle}"
                               TextWrapping="Wrap"
                               IsTextSelectionEnabled="True"
                               Margin="0,8,0,0"/>

                    <TextBlock x:Name="CacheSizeLabel" Text="Cache Size:" 
                               Grid.Row="3"
                               Style="{StaticResource BodyTextBlockStyle}"
                               Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                               Margin="0,8,0,0"/>
                    <TextBlock x:Name="CacheSizeText" 
                               Grid.Row="3" Grid.Column="1"
                               Style="{StaticResource BodyTextBlockStyle}"
                               IsTextSelectionEnabled="True"
                               Margin="0,8,0,0"/>
                </Grid>
            </Border>

            <!-- Log Viewer -->
            <StackPanel Orientation="Horizontal" Spacing="8" Margin="0,8,0,8">
                <FontIcon Glyph="&#xE756;" FontSize="18" Foreground="{ThemeResource AccentTextFillColorPrimaryBrush}"/>
                <TextBlock x:Name="LogFileSectionText" Text="Log File" Style="{StaticResource BodyStrongTextBlockStyle}"/>
            </StackPanel>
            
            <Border Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
                    BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                    BorderThickness="1"
                    CornerRadius="8"
                    Padding="16"
                    Margin="0,0,0,16">
                <StackPanel Spacing="12">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="200"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        
                        <TextBlock x:Name="CurrentLogFileLabel" Text="Current Log File:" 
                                   Style="{StaticResource BodyTextBlockStyle}"
                                   Foreground="{ThemeResource TextFillColorSecondaryBrush}"/>
                        <TextBlock x:Name="LogFilePathText" 
                                   Grid.Column="1"
                                   Style="{StaticResource BodyTextBlockStyle}"
                                   TextWrapping="Wrap"
                                   IsTextSelectionEnabled="True"/>
                    </Grid>
                    
                    <TextBlock x:Name="RecentLogEntriesLabel" Text="Recent Log Entries:" 
                               Style="{StaticResource BodyTextBlockStyle}"
                               Foreground="{ThemeResource TextFillColorSecondaryBrush}"/>
                    
                    <Border Background="{ThemeResource LayerOnMicaBaseAltFillColorDefaultBrush}"
                            CornerRadius="4"
                            Padding="12">
                        <ScrollViewer Height="200" HorizontalScrollBarVisibility="Auto">
                            <TextBlock x:Name="LogContentText"
                                       FontFamily="Consolas"
                                       FontSize="12"
                                       TextWrapping="NoWrap"
                                       IsTextSelectionEnabled="True"/>
                        </ScrollViewer>
                    </Border>
                    
                    <StackPanel Orientation="Horizontal" Spacing="8">
                        <Button Click="OpenLogFileButton_Click">
                            <StackPanel Orientation="Horizontal" Spacing="8">
                                <FontIcon Glyph="&#xE8A7;" FontSize="14"/>
                                <TextBlock x:Name="OpenLogFileButtonText" Text="Open Log File"/>
                            </StackPanel>
                        </Button>
                        <Button Click="RefreshLogButton_Click">
                            <StackPanel Orientation="Horizontal" Spacing="8">
                                <FontIcon Glyph="&#xE72C;" FontSize="14"/>
                                <TextBlock x:Name="RefreshLogButtonText" Text="Refresh Log"/>
                            </StackPanel>
                        </Button>
                    </StackPanel>
                </StackPanel>
            </Border>

            <!-- Migration -->
            <StackPanel Orientation="Horizontal" Spacing="8" Margin="0,8,0,8">
                <FontIcon Glyph="&#xE8AB;" FontSize="18" Foreground="{ThemeResource AccentTextFillColorPrimaryBrush}"/>
                <TextBlock x:Name="MigrationSectionText" Text="Legacy Migration" Style="{StaticResource BodyStrongTextBlockStyle}"/>
            </StackPanel>
            
            <Border Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
                    BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                    BorderThickness="1"
                    CornerRadius="8"
                    Padding="16"
                    Margin="0,0,0,16">
                <StackPanel Spacing="12">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="200"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>

                        <TextBlock x:Name="LegacyDataPresentLabel" Text="Legacy Data Present:" 
                                   Style="{StaticResource BodyTextBlockStyle}"
                                   Foreground="{ThemeResource TextFillColorSecondaryBrush}"/>
                        <TextBlock x:Name="LegacyDataText" 
                                   Grid.Column="1"
                                   Style="{StaticResource BodyTextBlockStyle}"/>

                        <TextBlock x:Name="MigrationCompleteLabel" Text="Migration Complete:" 
                                   Grid.Row="1"
                                   Style="{StaticResource BodyTextBlockStyle}"
                                   Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                                   Margin="0,8,0,0"/>
                        <TextBlock x:Name="MigrationStatusText" 
                                   Grid.Row="1" Grid.Column="1"
                                   Style="{StaticResource BodyTextBlockStyle}"
                                   Margin="0,8,0,0"/>
                    </Grid>

                    <ProgressBar x:Name="MigrationProgress" 
                                 Visibility="Collapsed"
                                 Maximum="100"/>

                    <Button x:Name="MigrateButton" 
                            Click="MigrateButton_Click">
                        <StackPanel Orientation="Horizontal" Spacing="8">
                            <FontIcon Glyph="&#xE8AB;" FontSize="14"/>
                            <TextBlock x:Name="MigrateDataButtonText" Text="Migrate Data"/>
                        </StackPanel>
                    </Button>
                </StackPanel>
            </Border>

            <!-- Actions -->
            <StackPanel Orientation="Horizontal" Spacing="8" Margin="0,8,0,8">
                <FontIcon Glyph="&#xE90F;" FontSize="18" Foreground="{ThemeResource AccentTextFillColorPrimaryBrush}"/>
                <TextBlock x:Name="ActionsSectionText" Text="Actions" Style="{StaticResource BodyStrongTextBlockStyle}"/>
            </StackPanel>
            
            <Border Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
                    BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                    BorderThickness="1"
                    CornerRadius="8"
                    Padding="16"
                    Margin="0,0,0,16">
                <StackPanel Spacing="8">
                    <Button Click="ClearCacheButton_Click" HorizontalAlignment="Stretch">
                        <StackPanel Orientation="Horizontal" Spacing="8">
                            <FontIcon Glyph="&#xE74D;" FontSize="14"/>
                            <TextBlock x:Name="ClearImageCacheButtonText" Text="Clear Image Cache"/>
                        </StackPanel>
                    </Button>
                    <Button Click="ResetSettingsButton_Click" HorizontalAlignment="Stretch">
                        <StackPanel Orientation="Horizontal" Spacing="8">
                            <FontIcon Glyph="&#xE777;" FontSize="14"/>
                            <TextBlock x:Name="ResetSettingsButtonText" Text="Reset Settings"/>
                        </StackPanel>
                    </Button>
                    <Button Click="OpenAppFolderButton_Click" HorizontalAlignment="Stretch">
                        <StackPanel Orientation="Horizontal" Spacing="8">
                            <FontIcon Glyph="&#xE8B7;" FontSize="14"/>
                            <TextBlock x:Name="OpenAppFolderButtonText" Text="Open App Folder"/>
                        </StackPanel>
                    </Button>
                    <Button Click="OpenInstallFolderButton_Click" HorizontalAlignment="Stretch">
                        <StackPanel Orientation="Horizontal" Spacing="8">
                            <FontIcon Glyph="&#xE838;" FontSize="14"/>
                            <TextBlock x:Name="OpenInstallFolderButtonText" Text="Open Install Folder"/>
                        </StackPanel>
                    </Button>
                </StackPanel>
            </Border>

            <!-- Test Section -->
            <StackPanel Orientation="Horizontal" Spacing="8" Margin="0,8,0,8">
                <FontIcon Glyph="&#xE9D9;" FontSize="18" Foreground="{ThemeResource AccentTextFillColorPrimaryBrush}"/>
                <TextBlock x:Name="TestsSectionText" Text="Tests" Style="{StaticResource BodyStrongTextBlockStyle}"/>
            </StackPanel>
            
            <Border Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
                    BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                    BorderThickness="1"
                    CornerRadius="8"
                    Padding="16">
                <StackPanel Spacing="8">
                    <Button Click="TestToastButton_Click" HorizontalAlignment="Stretch">
                        <StackPanel Orientation="Horizontal" Spacing="8">
                            <FontIcon Glyph="&#xE7E7;" FontSize="14"/>
                            <TextBlock x:Name="TestNotificationButtonText" Text="Test Notification"/>
                        </StackPanel>
                    </Button>
                    <Button Click="TestThemeButton_Click" HorizontalAlignment="Stretch">
                        <StackPanel Orientation="Horizontal" Spacing="8">
                            <FontIcon Glyph="&#xE793;" FontSize="14"/>
                            <TextBlock x:Name="ToggleThemeButtonText" Text="Toggle Theme"/>
                        </StackPanel>
                    </Button>
                    <Button Click="TestSteamButton_Click" HorizontalAlignment="Stretch">
                        <StackPanel Orientation="Horizontal" Spacing="8">
                            <FontIcon Glyph="&#xE7FC;" FontSize="14"/>
                            <TextBlock x:Name="TestSteamConnectionButtonText" Text="Test Steam Connection"/>
                        </StackPanel>
                    </Button>
                </StackPanel>
            </Border>
        </StackPanel>
    </ScrollViewer>
</Page>
