<?xml version="1.0" encoding="utf-8"?>
<UserControl
    x:Class="SAM.WinUI.Controls.GameCard"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="using:SAM.WinUI.Controls">

    <Grid Width="230" 
          Height="120" 
          CornerRadius="8"
          BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
          BorderThickness="1"
          PointerEntered="Grid_PointerEntered"
          PointerExited="Grid_PointerExited">
        
        <Grid.RowDefinitions>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Game Logo/Image - spans entire card for glassmorphism effect -->
        <Border Grid.RowSpan="2" CornerRadius="8">
            <Image x:Name="GameImage"
                   Source="{x:Bind ImageUrl, Mode=OneWay}" 
                   Stretch="UniformToFill"
                   HorizontalAlignment="Center"/>
        </Border>
        
        <!-- Subtle gradient overlay for better text readability -->
        <Border Grid.RowSpan="2" CornerRadius="8">
            <Border.Background>
                <LinearGradientBrush StartPoint="0,0" EndPoint="0,1">
                    <GradientStop Color="Transparent" Offset="0.0"/>
                    <GradientStop Color="Transparent" Offset="0.4"/>
                    <GradientStop Color="#B0000000" Offset="1.0"/>
                </LinearGradientBrush>
            </Border.Background>
        </Border>

        <!-- DRM Protection Overlay (greyed out effect) -->
        <Border x:Name="DrmOverlay"
                Grid.RowSpan="2"
                CornerRadius="8"
                Background="#80808080"
                Visibility="Collapsed"/>

        <!-- DRM Warning Icon (top right corner) -->
        <Border x:Name="DrmWarningIcon"
                Grid.Row="0"
                HorizontalAlignment="Right"
                VerticalAlignment="Top"
                Margin="8"
                Padding="6"
                CornerRadius="4"
                Background="{ThemeResource SystemFillColorCautionBackgroundBrush}"
                Visibility="Collapsed"
                ToolTipService.ToolTip="{x:Bind DrmProtectionInfo, Mode=OneWay}">
            <FontIcon Glyph="&#xE7BA;" 
                      FontSize="14"
                      Foreground="{ThemeResource SystemFillColorCautionBrush}"/>
        </Border>

        <!-- Game Info with Glassmorphism -->
        <Border Grid.Row="1"
                CornerRadius="0,0,8,8"
                Background="#E6000000">
            <Grid Padding="12,8">
                <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>

            <TextBlock x:Name="GameNameText"
                       Text="{x:Bind GameName, Mode=OneWay}" 
                       Style="{StaticResource BodyStrongTextBlockStyle}"
                       Foreground="White"
                       TextTrimming="CharacterEllipsis"
                       MaxLines="1"
                       ToolTipService.ToolTip="{x:Bind GameName, Mode=OneWay}"/>

            <StackPanel Grid.Row="1" 
                        Orientation="Horizontal" 
                        Spacing="8"
                        Margin="0,4,0,0">
                <FontIcon Glyph="&#xE7C1;" 
                          FontSize="12"
                          Foreground="#B0FFFFFF"/>
                <TextBlock Style="{StaticResource CaptionTextBlockStyle}"
                           Foreground="#B0FFFFFF">
                    <Run Text="{x:Bind AchievementCount, Mode=OneWay}"/>
                    <Run Text="Achievements"/>
                </TextBlock>
            </StackPanel>
            </Grid>
        </Border>

        <!-- Selection Indicator / Hover Effect -->
        <Border x:Name="SelectionBorder"
                Grid.RowSpan="2"
                CornerRadius="8"
                BorderThickness="2"
                BorderBrush="{ThemeResource AccentFillColorDefaultBrush}"
                Opacity="0"/>
    </Grid>
</UserControl>
